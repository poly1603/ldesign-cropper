{"version":3,"file":"Cropper.cjs","sources":["../src/Cropper.tsx"],"sourcesContent":["import { createEffect, createSignal, onCleanup, onMount, type Component, type JSX } from 'solid-js'\r\nimport { Cropper as CropperCore, type CropperOptions } from '@ldesign/cropper-core'\r\n\r\nexport interface CropperProps {\r\n  src?: string\r\n  aspectRatio?: number\r\n  viewMode?: 0 | 1 | 2 | 3\r\n  dragMode?: 'crop' | 'move' | 'none'\r\n  options?: CropperOptions\r\n  onReady?: (event: CustomEvent) => void\r\n  onCropstart?: (event: CustomEvent) => void\r\n  onCropmove?: (event: CustomEvent) => void\r\n  onCropend?: (event: CustomEvent) => void\r\n  onCrop?: (event: CustomEvent) => void\r\n  onZoom?: (event: CustomEvent) => void\r\n  class?: string\r\n  style?: JSX.CSSProperties\r\n}\r\n\r\nexport const Cropper: Component<CropperProps> = (props) => {\r\n  let containerRef: HTMLDivElement | undefined\r\n  let cropper: CropperCore | undefined\r\n  const [isReady, setIsReady] = createSignal(false)\r\n\r\n  onMount(() => {\r\n    if (containerRef) {\r\n      const options: CropperOptions = {\r\n        ...props.options,\r\n        src: props.src,\r\n        aspectRatio: props.aspectRatio,\r\n        viewMode: props.viewMode,\r\n        dragMode: props.dragMode,\r\n        ready: (e) => {\r\n          setIsReady(true)\r\n          props.onReady?.(e)\r\n        },\r\n        cropstart: props.onCropstart,\r\n        cropmove: props.onCropmove,\r\n        cropend: props.onCropend,\r\n        crop: props.onCrop,\r\n        zoom: props.onZoom\r\n      }\r\n\r\n      cropper = new CropperCore(containerRef, options)\r\n    }\r\n  })\r\n\r\n  createEffect(() => {\r\n    if (cropper && props.aspectRatio !== undefined) {\r\n      cropper.setAspectRatio(props.aspectRatio)\r\n    }\r\n  })\r\n\r\n  createEffect(() => {\r\n    if (cropper && props.src) {\r\n      cropper.replace(props.src)\r\n    }\r\n  })\r\n\r\n  onCleanup(() => {\r\n    cropper?.destroy()\r\n  })\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      class={props.class}\r\n      style={{\r\n        width: '100%',\r\n        height: '100%',\r\n        'min-height': '400px',\r\n        ...props.style\r\n      }}\r\n    />\r\n  )\r\n}\r\n\r\n// Export composable for advanced usage\r\nexport function useCropper() {\r\n  const [cropper, setCropper] = createSignal<CropperCore | undefined>()\r\n\r\n  const initCropper = (element: HTMLElement, options: CropperOptions) => {\r\n    const instance = new CropperCore(element, options)\r\n    setCropper(instance)\r\n    return instance\r\n  }\r\n\r\n  const destroyCropper = () => {\r\n    cropper()?.destroy()\r\n    setCropper(undefined)\r\n  }\r\n\r\n  onCleanup(() => {\r\n    destroyCropper()\r\n  })\r\n\r\n  return {\r\n    cropper,\r\n    initCropper,\r\n    destroyCropper\r\n  }\r\n}\r\n"],"names":["props","containerRef","cropper","isReady","setIsReady","createSignal","onMount","options","src","aspectRatio","viewMode","dragMode","ready","e","onReady","cropstart","onCropstart","cropmove","onCropmove","cropend","onCropend","crop","onCrop","zoom","onZoom","CropperCore","createEffect","undefined","setAspectRatio","replace","onCleanup","destroy","_el$","_tmpl$","_ref$","_$use","_$effect","_p$","_v$","class","_v$2","width","height","style","_$className","t","_$style","setCropper","destroyCropper","initCropper","element","instance"],"mappings":";;;;;;;;;iKAmBiDA,IAC/C,IAAIC,EACAC,EACJ,MAAOC,EAASC,GAAcC,EAAAA,cAAa,GAyC3C,OAvCAC,EAAAA,QAAQ,KACN,GAAIL,EAAc,CAChB,MAAMM,EAA0B,IAC3BP,EAAMO,QACTC,IAAKR,EAAMQ,IACXC,YAAaT,EAAMS,YACnBC,SAAUV,EAAMU,SAChBC,SAAUX,EAAMW,SAChBC,MAAQC,IACNT,GAAW,GACXJ,EAAMc,UAAUD,IAElBE,UAAWf,EAAMgB,YACjBC,SAAUjB,EAAMkB,WAChBC,QAASnB,EAAMoB,UACfC,KAAMrB,EAAMsB,OACZC,KAAMvB,EAAMwB,QAGdtB,EAAU,IAAIuB,EAAAA,QAAYxB,EAAcM,EAC1C,IAGFmB,EAAAA,aAAa,KACPxB,QAAiCyB,IAAtB3B,EAAMS,aACnBP,EAAQ0B,eAAe5B,EAAMS,eAIjCiB,EAAAA,aAAa,KACPxB,GAAWF,EAAMQ,KACnBN,EAAQ2B,QAAQ7B,EAAMQ,OAI1BsB,EAAAA,UAAU,KACR5B,GAAS6B,YAGXC,EAAAC,IAEqB,mBAFrBC,EAESjC,GAAYkC,EAAAA,IAAAD,EAAAF,GAAZ/B,EAAY+B,EAAAI,EAAAA,OAAAC,IAAA,IAAAC,EACVtC,EAAMuC,MAAKC,EACX,CACLC,MAAO,OACPC,OAAQ,UAEL1C,EAAM2C,OACV,OAAAL,IAAAD,EAAAxB,GAAA+B,EAAAA,UAAAZ,EAAAK,EAAAxB,EAAAyB,GAAAD,EAAAQ,EAAAC,EAAAA,MAAAd,EAAAQ,EAAAH,EAAAQ,GAAAR,GAAA,CAAAxB,OAAAc,EAAAkB,OAAAlB,IAAAK,EATL,IAAAA,EAAAE,iCAgBA,MAAOhC,EAAS6C,GAAc1C,iBAQxB2C,EAAiBA,KACrB9C,KAAW6B,UACXgB,OAAWpB,IAOb,OAJAG,EAAAA,UAAU,KACRkB,MAGK,CACL9C,UACA+C,YAjBkBA,CAACC,EAAsB3C,KACzC,MAAM4C,EAAW,IAAI1B,UAAYyB,EAAS3C,GAE1C,OADAwC,EAAWI,GACJA,GAePH,iBAEJ"}